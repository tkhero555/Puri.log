<div class="bg-base-200 space-y-10">
  <div class="md:flex justify-center items-center gap-4 space-y-4 mx-auto max-w-screen-md">
    <div class="card w-96 bg-base-100 shadow-xl mx-auto">
      <div class="card-body">
        <h2 class="card-title">食事の記録</h2>
        <%= form_with url: meals_path, class: "w-full max-w-md" do |f| %>
          <div class="md:flex md:items-center mb-6">
            <div class="md:w-1/3">
              <%= f.label :meal_name, "食事名", class: "block text-gray-500 font-bold md:text-right mb-1 md:mb-0 pr-4" %>
            </div>
            <div class="md:w-2/3">
              <%= f.text_field :meal_name, class: "bg-gray-200 appearance-none border-2 border-gray-200 rounded w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500" %>
            </div>
          </div>
          <div class="md:flex md:items-center mb-6">
            <div class="md:w-1/3">
              <%= f.label :created_at, "食べた時間", class: "block text-gray-500 font-bold md:text-right mb-1 md:mb-0 pr-4" %>
            </div>
            <div class="md:w-2/3">
              <%= f.datetime_field :created_at, value: Time.current.strftime('%Y-%m-%dT'), class: "bg-gray-200 appearance-none border-2 border-gray-200 rounded w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500" %>
            </div>
          </div>
          <div class="md:flex md:items-center">
            <div class="md:w-1/3"></div>
            <div class="md:w-2/3">
              <%= f.submit "記録する", class: "btn btn-ghost shadow bg-base-300 hover:bg-base-400 focus:shadow-outline focus:outline-none font-bold py-2 px-4 rounded" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <div class="card w-96 bg-base-100 shadow-xl mx-auto">
      <div class="card-body">
        <h2 class="card-title">排便の記録</h2>
        <%= form_with url: stools_path, class: "w-full max-w-md" do |f| %>
          <div class="md:flex md:items-center mb-6">
            <div class="md:w-1/3">
              <%= f.label :condition, "便の状態", class: "block text-gray-500 font-bold md:text-right mb-1 md:mb-0 pr-4" %>
            </div>
            <div class="md:w-2/3">
              <%= f.select :condition, [["0.良い", 0], ["1.普通", 1], ["2.悪い", 2]], {include_blank: "選択して下さい"}, class: "bg-gray-200 border-2 border-gray-200 rounded w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500" %>
            </div>
          </div>
          <div class="md:flex md:items-center mb-6">
            <div class="md:w-1/3">
              <%= f.label :created_at, "出した日時", class: "block text-gray-500 font-bold md:text-right mb-1 md:mb-0 pr-4" %>
            </div>
            <div class="md:w-2/3">
              <%= f.datetime_field :created_at, value: Time.current.strftime('%Y-%m-%dT'), class: "bg-gray-200 appearance-none border-2 border-gray-200 rounded w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500" %>
            </div>
          </div>
          <div class="md:flex md:items-center">
            <div class="md:w-1/3"></div>
            <div class="md:w-2/3">
              <%= f.submit "記録する", class: "btn btn-ghost shadow bg-base-300 hover:bg-base-400 focus:shadow-outline focus:outline-none font-bold py-2 px-4 rounded" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  <div class="md:flex justify-center items-center gap-4 space-y-4 mx-auto max-w-screen-md">
    <div class="card w-96 max-h-96 bg-base-100 shadow-xl mx-auto">
      <div class="card-body">
        <h2 class="card-title">おすすめの食事</h2>
        <div class="max-h-72 overflow-auto">
          <% @recommend_meals.each do |recommend_meal| %>
            <p><%= recommend_meal.meal_name %></p>
          <% end %>
        </div>
      </div>
    </div>
    <div class="card w-96 max-h-96 bg-base-100 shadow-xl mx-auto">
      <div class="card-body">
        <h2 class="card-title">避けるべき食事</h2>
        <div class="max-h-72 overflow-auto">
          <% @avert_meals.each do |avert_meal| %>
            <p><%= avert_meal.meal_name %></p>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <div>
    <%= month_calendar(events: @log_index, attribute: :created_at) do |date, logs| %>
      <%= date.day %>

      <% logs.each do |log| %>
      <div>
        <% if log.is_a?(Eating) %>
          <%= log.meal.meal_name %>
        <% elsif log.is_a?(Stool) %>
          <% if log.condition == "good" %>
            <p>良い</p>
          <% elsif log.condition == "normal" %>
            <p>普通</p>
          <% elsif log.condition == "bad" %>
            <p>悪い</p>
          <% else %>
            <%= log.condition %>
          <% end %>
        <% end %>
      </div>
      <% end %>
    <% end %>
  </div>
  <div class="card w-96 max-h-96 bg-base-100 shadow-xl mx-auto">
    <div class="card-body">
      <h2 class="card-title">記録履歴一覧</h2>
      <div class="max-h-72 overflow-auto">
        <table class="table table-xs table-pin-rows table-pin-cols">
          <thead>
            <tr>
              <th></th> 
              <td>食事名</td> 
              <td>便の状態</td> 
              <td>記録日時</td> 
              <td>削除ボタン</td> 
              <th></th> 
            </tr>
          </thead> 
          <% @log_index.each do |log| %>
            <% if log.is_a?(Eating) %>
              <tbody>
                <tr>
                  <th></th>
                  <td><%= log.meal.meal_name %></td>
                  <td>-</td> 
                  <td><%= log.created_at.strftime('%Y-%m-%d %H:%M') %></td>
                  <% unless current_user.id == 2 %>
                    <td><%= button_to '削除', eating_path(log.id), method: :delete %></td>
                  <% end %>
                  <th></th>
                </tr>
              </tbody> 
            <% elsif log.is_a?(Stool) %>
              <tbody>
                <tr>
                  <th></th>
                  <td>-</td> 
                  <% if log.condition == "good" %>
                    <td>良い</td>
                  <% elsif log.condition == "normal" %>
                    <td>普通</td>
                  <% elsif log.condition == "bad" %>
                    <td>悪い</td>
                  <% else %>
                    <td><%= log.condition %></td>
                  <% end %>
                  <td><%= log.created_at.strftime('%Y-%m-%d %H:%M') %></td>
                  <% unless current_user.id == 2 %>
                    <td><%= button_to '削除', stool_path(log.id), method: :delete %></td>
                  <% end %>
                  <th></th>
                </tr>
              </tbody> 
            <% end %>
          <% end %>
        </table>
      </div>
    </div>
  </div>
</div>
